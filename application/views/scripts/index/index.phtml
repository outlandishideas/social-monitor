<?php
    $links = $this->gatekeeper()->filterAll(array(
        '<a class="button add" href="%url%">Add new Country</a>' => array('action' => 'new', 'type'=>'campaign')
    ));
?>

<div id="geo-map"></div>

<div id="overview"></div>

<div>
    <h2>Countries</h2>
    <?php if ($links) : ?>
    <p>
        <?php echo implode('', $links); ?>
    </p>
    <?php endif; ?>
</div>

<table class="text">
    <tr>
        <th>Name</th>
        <th>Statuses <abbr title="Month to date">MTD</abbr></th>
        <th>Handles</th>
        <th>Pages</th>
        <th></th>
    </tr>
    <?php foreach ($this->campaigns as $campaign) : ?>
    <tr>
        <td><?php echo $this->gatekeeper()->filter('<a href="%url%">' . $campaign->name . '</a>', array('action'=>'view', 'id'=>$campaign->id)); ?></td>
        <td><?php echo number_format($campaign->statusCountThisMonth); ?></td>
        <td><?php echo count($campaign->FacebookPages); ?></td>
        <td>0</td>
        <td>
            <?php
            $links = $this->gatekeeper()->filterAll(array(
                '<a href="%url%">Edit</a>' => array('action'=>'edit', 'id'=>$campaign->id),
//                '<a href="%url%">Update info</a>' => array('action'=>'update', 'id'=>$campaign->id), // todo: this is now done in the fetch controller. is the link still needed?
                '<a href="%url%" class="autoConfirm">Delete</a>' => array('action'=>'delete', 'id'=>$campaign->id)
            ));
            echo implode(' | ', $links);
            ?>
        </td>
    </tr>
    <?php endforeach; ?>
</table>