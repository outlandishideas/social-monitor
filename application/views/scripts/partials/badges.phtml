<?php

$locale = 'en_US';
$nf = new NumberFormatter($locale, NumberFormatter::ORDINAL);

?>

<div class="badges">
    <div class="badge-main bd-btm">
        <?php $badge = $this->badges['main']; ?>
        <h2 class="bd-btm"><?php echo $badge['title']; ?></h2>
        <div class="row">
            <div class="small-24 medium-12 columns">

                <div class="badge-rank">
                    <h3>Rank</h3>
                    <div class="rank-value">
                        <span class="numerator"><?php echo $badge['rank']['value']; ?><span><?php echo trim(str_replace(range(0,9),'',$nf->format($badge['rank']['value'])));?></span></span><span class="denominator">/<?php echo $badge['rank']['denominator']; ?></span>
                    </div>
                </div>

            </div>
            <div class="small-24 medium-12 columns">

                <div class="badge-score">
                    <h3>Score</h3>
                    <div class="score-value" style="color:<?php echo $badge['score']['color']; ?>;">
                        <?php echo $badge['score']['value']; ?>%
                    </div>
                </div>

            </div>
        </div>

    </div>
    <div class="row">
        <?php foreach($this->badges['small'] as $badge) : ?>
            <div class="small-24 medium-8 columns">
                <div class="badge-small">
                    <h2 class="bd-btm"><?php echo $badge['title']; ?></h2>

                    <div class="badge-rank bd-btm">
                        <h3>Rank</h3>
                        <div class="rank-value">
                            <!-- breaking the line causes the display not display properly -->
                            <span class="numerator"><?php echo $badge['rank']['value']; ?><span><?php echo trim(str_replace(range(0,9),'',$nf->format($badge['rank']['value'])));?></span></span><span class="denominator">/<?php echo $badge['rank']['denominator']; ?></span>
                        </div>
                    </div>

                    <div class="badge-score bd-btm">
                        <h3>Score</h3>
                        <div class="score-value" style="color:<?php echo $badge['score']['color']; ?>;">
                            <?php echo $badge['score']['value']; ?>%
                        </div>
                        <div class="score-bar">
                            <div class="score-bar-score" style="background:<?php echo $badge['score']['color']; ?>; width: <?php echo $badge['score']['value']; ?>%;"></div>
                        </div>
                    </div>

                    <ul class="badge-metrics show-for-large-up">
                        <?php foreach($badge['metrics'] as $metric): ?>
                            <li
                                class="bd-btm"
                                <?php if (!empty($this->titles)) : ?>
                                    <?php if (array_key_exists('score', $metric)): ?>
                                        style="color: <?php echo($metric['color']); ?>"
                                        <?php if ($metric['score'] > 0): ?>
                                            title="This presence has scored <?php echo($metric['score']); ?>% for <?php echo $metric['title']; ?>."
                                        <?php else: ?>
                                            <?php if ($metric['gliding']): ?>
                                                title="There is no data available to calculate <?php echo $metric['title']; ?>."
                                            <?php else: ?>
                                                title="This presence has scored 0% for <?php echo $metric['title']; ?>."
                                            <?php endif; ?>
                                        <?php endif; ?>
                                    <?php else : ?>
                                        title="<?php echo $metric['title']; ?> is not applicable for this presence"
                                    <?php endif; ?>
                                <?php endif; ?>
                            >
                                <span class="<?php echo $metric['icon']; ?> fa-fw"></span> <?php echo $metric['title']; ?>
                            </li>
                        <?php endforeach; ?>
                    </ul>

                </div>
            </div>
        <?php endforeach; ?>
    </div>
</div>