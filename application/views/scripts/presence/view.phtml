<?php
$buttons = $this->gatekeeper()->filterAll(array(
    '<a class="button" href="%url%"><span class="icon-edit icon-large"></span> Edit Presence</a>' => array('action'=>'edit', 'id'=>$this->presence->id)
));
?>

<?php if ($buttons) : ?>
    <p>
        <?php echo implode('', $buttons); ?>
    </p>
<?php endif; ?>

<div class="section-title">
    <h2>Badges</h2>
</div>

<div id="badges" data-id="<?php echo $this->presence->id; ?>" class="grid justify" data-controller="presence">
    <?php
        foreach($this->badges as $name => $badge) {
            echo $this->partial('partials/badges.phtml', array('badge'=>$badge));
        }
    ?>
</div>

<div id="charts" data-controller="presence">

    <div id="pickers">
        <?php echo $this->render('partials/daterange.phtml'); ?>
    </div>

    <?php
	$currentId = 1;
	foreach ($this->graphs as $graph) {
		$graph->id = $currentId++;
		$graph->presence_id = $this->presence->id;
		$this->graph = $graph;
    ?>
        <div class="section-title">
            <h2><?php echo $graph->title; ?></h2>
        </div>
    <?php
		echo $this->render('partials/chart.phtml');
	}
	?>
</div>

<div id="statuses" class="statusesDisplay <?php echo $this->presence->type; ?>" data-presence-id="<?php echo $this->presence->id; ?>">
	<div class="inner">
		<h3>Statuses</h3>
		<table>
			<thead>
				<tr>
				<?php if ($this->presence->isForFacebook()) : ?>
					<th class="user">User</th>
					<th class="message">Message</th>
					<th class="links">Links</th>
					<th class="response">Response</th>
					<th class="date">Date</th>
				<?php else : ?>
					<th class="message">Message</th>
					<th class="date">Date</th>
				<?php endif; ?>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
</div>
